<?xml version="1.0"?>
<!DOCTYPE installer PUBLIC "-//tp23 //DTD Ant Installer Config//EN" "http://antinstaller.sf.net/dtd/antinstall-config-0.8.dtd">
<installer ui="swing,text" verbose="false"
	lookAndFeel="org.tp23.jgoodies.plaf.plastic.PlasticXPLookAndFeel"
	name="caNanoLab Installer"
	windowIcon="/resources/extract-image.gif"
	defaultImageResource="/resources/appLogo-nanolab.gif"
	minJavaVersion="1.5" finishButtonText="Install" wide="600:375"
	debug="false">

	<!--  each page element represents a page of the installer -->
	<page type="input" name="intro"
		displayText="Welcome to the caNanoLab installer">

		<comment displayText="Installation Information:" bold="true" />
		<comment
			displayText="This installer will install the caNanoLab software with JBoss 4.0.05-GA and MySQL 5.0.45"
			bold="false" />
	</page>
	<!--  type="license" shows a license page to click through -->
	<page type="license" name="license" displayText="License conditions"
		resource="/resources/LICENSE.txt">
	</page>
	<!--  type="license" shows a license page to click through
	
	<page type="text" name="release_notes" displayText="Release Notes" htmlResource="/resources/release_notes.html" textResource="/resources/release_notes.txt">
	</page>
	-->
	<!--  type="input" shows a list of editable options for the installer -->
	<page type="input" name="input.file"
		displayText="Installation Folder">
		<comment displayText="" bold="true" />
			
		<directory displayText="Enter the destination folder for the caNanoLab application:" 
			defaultValue="${java.user.home}/cananolab-app" 
			defaultValueWin="C:/cananolab-app" 
			property="temp.dir"/>
		
			
		<directory displayText="Enter the destination folder for the Jboss Server:" 
			defaultValue="${java.user.home}/cananolab-app" 
			defaultValueWin="C:/cananolab-app"
			property="jboss.dir"/>

			
		<directory displayText="Enter the destination folder for the mySql Database" 
			defaultValue="${java.user.home}/cananolab-app" 
			defaultValueWin="C:/cananolab-app"
			property="mysql.dir"/>	
	<!--	
	    grid installation
		<directory displayText="Enter the destination folder for the Tomcat Server" 
			defaultValue="C:/cananolab-app" 
			property="tomcat.dir"/>
		
		<directory displayText="Enter the destination folder for the ws-grid" 
			defaultValue="C:/cananolab-app" 
			property="ws-grid.dir"/>

		<directory displayText="Enter the destination folder for the Nano-grid" 
			defaultValue="C:/cananolab-app" 
			property="nano-grid.dir"/>
	-->		
			
    	</page>
	
	<page type="input" name="jboss.config"
		displayText="Jboss Configuration">
		<comment displayText="" bold="true" />	
			
		<ext-validated
			property="jboss.http.port"
			displayText="Http Port Number" 
			defaultValue="18080" 
			validationClass="com.install.customvalidate.ValidatePort" />
		
		
		<ext-validated
			property="jboss.rmi.port"
			displayText="RMI Bind Port Number" 
			defaultValue="18009" 
			validationClass="com.install.customvalidate.ValidatePort" />
			
		<ext-validated
			property="jboss.redirect.port"
			displayText="Redirect Port Number" 
			defaultValue="18443" 
			validationClass="com.install.customvalidate.ValidatePort" />

		<hidden
			property="os"
			value="${os.name}"
		/>
		
   	</page>	


	
	<page type="input" name="mysql.config"
		displayText="MySQL configuration for Windows" ifProperty="(${java.os.name}=Windows XP)OR(${java.os.name}=Windows 2000)" >
		<comment displayText="" bold="true" />


		<ext-validated
			property="database.port"
			displayText="Database Port Number" 
			defaultValue="3307" 
			validationClass="com.install.customvalidate.ValidatePort" />

		<text
			property="database.system.user"
			displayText="Database System User" 
			defaultValue="root" 
			/>

		<text
			property="database.system.password"
			displayText="Database System Password" 
			defaultValue="mysql" 
			/>
		
		<text
			property="database.password"
			displayText="Database User Password" 
			defaultValue="go!23" 
			/>		
			
   	</page>	
   	
	<page type="input" name="linux.mysql.config"
		displayText="MySQL configuration for linux" ifProperty="${java.os.name}=Linux" >
		<hidden property="checkdb" value="true" />
		<hidden property="dbvalid" value="false" />
		
		<comment displayText="" bold="true" />

		<text
			property="database.server"
			displayText="Database Host Name" 
			defaultValue="localhost" 			
			/>

		<text
			property="database.port"
			displayText="Database Port Number" 
			defaultValue="3306" 
			/>

		<text
			property="database.system.user"
			displayText="Database System User" 
			defaultValue="root" 
			/>

		<ext-validated
			property="database.system.password"
			displayText="Database System Password" 
			defaultValue="mysql" 
			validationClass="com.install.customvalidate.ValidateConnection" 
			/>

		<text
			property="database.password"
			displayText="Database User Password" 
			defaultValue="go!23" 
			/>		

		
		

   	</page>	

	<page type="input" name="linux.mysql.confirmation"
		displayText="Testing the database connection" ifProperty="(${checkdb}=true) AND (${dbvalid}=false)" postDisplayTarget="antinstaller-checkdb" >	
		<comment displayText="" bold="true" />

    		<comment displayText="Press Next to test the database connection ..." />
    		
    		<hidden property="db.server" value="${database.server}"  />
    		<hidden property="db.port" value="${database.port}"  />
    		<hidden property="db.system.user" value="${database.system.user}"  />
    		<hidden property="db.system.password" value="${database.system.password}"  />
    		<hidden property="jdbc.url" value="jdbc:mysql://${db.server}:${db.port}/mysql"  />
    		
   	</page>	   	

	<page type="input" name="linux.mysql.dbcheck"
		displayText="MySQL configuration for linux" ifProperty="(${checkdb}=true) AND (${dbvalid}=false)" >
		<comment displayText="" bold="true" />
		<comment displayText="Please go back and specify the correct database configurtion parameters." bold="true" />
    		
		<hidden property="checkdb" value="false" />
 		<hidden property="db.server" value=""  />
    		<hidden property="db.port" value=""  />
    		<hidden property="db.system.user" value=""  />
    		<hidden property="db.system.password" value=""  />
    		<hidden property="jdbc.url" value=""  />
   
   	</page>	

	<page type="input" name="build.properties"
		displayText="Enter the build properties">
		<comment displayText="" bold="true" />

		<directory
			property="file.repository.dir"
			displayText="Enter the File Repository directory" 
			defaultValue="${java.user.home}/caNanoLab/fileupload" 
			defaultValueWin="C:/temp/caNanoLab/fileupload" 
			/>

		<text
			property="sample.prefix"
			displayText="Enter the Sameple Prefix" 
			defaultValue="NCL" 
			/>
		
		<text
			property="application.owner"
			displayText="Enter the Application Owner" 
			defaultValue="NCL" 
			/>		

		<text
			property="grid.indexserver"
			displayText="Enter the Index Server with which the Grid servers are registered" 
			defaultValue="cagrid-index.nci.nih.gov:8080" 
			/>	
			
		<text
			property="database"
			displayText="Enter the Database" 
			defaultValue="mysql" 
			/>				
			
   	</page>

	
	<page type="input" name="patchOptions" displayText="Confirmation">
		<comment
			displayText="Install caNanoLab?"
			bold="true" />
		<comment displayText="" bold="true" />
		<target displayText="Please confirm the caNanoLab installation."
			target="auto-update" defaultValue="Yes"
			osSpecific="true"
        		strict="false" 
			/>
		<target displayText="Please confirm the Jboss installation."
			target="jboss-install" defaultValue="Yes"
			osSpecific="true"
        		strict="false" 
			/>
		<target displayText="Please confirm the mysql installation."
			target="mysql-install" defaultValue="Yes"
			osSpecific="true"
        		strict="false" 
			/>
		<target displayText="migrate mysql data to new version."
			target="migrate-mysql" defaultValue="Yes" 
			/>
<!--			
		<target displayText="Please confirm the jboss configuration."
			target="configure-jboss" defaultValue="Yes" />
			
		<target displayText="Please confirm the Grid installation."
			target="grid-install" defaultValue="Yes" />			
-->		
	</page>

	<!--  page type="progress" shows a progress page with the install button
		Its target is set to cleanuptarget since it is the last page this target will be run last-->
	<page type="progress" name="progress" showTargets="false"
		displayText="Installation progress" target="cleanuptarget">

	</page>
</installer>


