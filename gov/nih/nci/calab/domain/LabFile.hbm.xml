<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="gov.nih.nci.calab.domain">
	<class name="LabFile" table="lab_file">
		<cache usage="read-write" />
		<id name="id" type="java.lang.Long" column="file_pk_id"
			unsaved-value="0">
			<generator class="org.hibernate.id.TableHiLoGenerator">
				<param name="table">hibernate_unique_key</param>
				<param name="column">next_hi</param>
			</generator>
		</id>
		<discriminator column="file_source_type" type="string" />
		<property name="extension" type="java.lang.String"
			column="file_type_extension" />
		<property name="createdBy" type="java.lang.String"
			column="created_by" />
		<property name="createdDate" type="java.util.Date"
			column="created_date" />
		<property name="version" type="java.lang.String"
			column="version" />
		<property name="uri" type="java.lang.String" column="file_uri" />
		<property name="filename" type="java.lang.String"
			column="file_name" />
		<property name="title" type="java.lang.String" column="title" />
		<property name="description" type="java.lang.String"
			column="description" />
		<property name="comments" type="java.lang.String"
			column="comments" />
		<property name="type" type="java.lang.String" column="type" />
		<joined-subclass name="gov.nih.nci.calab.domain.SampleSOPFile"
			table="view_sample_sop_file">
			<key column="sop_file_pk_id" />
			<many-to-one name="sampleSOP"
				class="gov.nih.nci.calab.domain.SampleSOP"
				column="sample_sop_pk_id" />
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.nano.characterization.DerivedBioAssayData"
			table="derived_bioassay_data">
			<key column="derived_bioassay_data_pk_id" />
			<array name="categories" table="bioassay_data_data_category"> 
				<key column="derived_bioassay_data_pk_id"></key> 
				<index column="category_index"></index> 
				<element column="category_name" type="string" /> 
			</array>  			
			<list name="datumCollection" cascade="all-delete-orphan" lazy="true">
			<cache usage="read-write" />
			<key column="derived_bioassay_data_pk_id" />
			<list-index column="list_index" />
			<one-to-many class="gov.nih.nci.calab.domain.nano.characterization.Datum" />
		    </list>
			<set name="keywordCollection" table="keyword_bioassay_data"
				cascade="all-delete-orphan" lazy="false">
				<cache usage="read-write" />
				<key column="derived_bioassay_data_pk_id" />
				<many-to-many class="gov.nih.nci.calab.domain.Keyword"
					column="keyword_pk_id" />
			</set>
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.AssociatedFile"
			table="associated_file">
			<key column="associated_file_pk_id" />
			<set name="particleCollection"
				table="sample_associated_file" cascade="all-delete-orphan"
				lazy="true">
				<cache usage="read-write" />
				<key column="associated_file_pk_id" />
				<many-to-many
					class="gov.nih.nci.calab.domain.nano.particle.Nanoparticle"
					column="sample_pk_id" />
			</set>
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.Report"
			table="report">
			<key column="report_pk_id" />
			<set name="particleCollection" table="sample_report"
				cascade="all-delete-orphan" lazy="true">
				<cache usage="read-write" />
				<key column="file_pk_id" />
				<many-to-many
					class="gov.nih.nci.calab.domain.nano.particle.Nanoparticle"
					column="sample_pk_id" />
			</set>
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.ProtocolFile"
			table="protocol_file">
			<key column="protocol_file_pk_id" />
			<many-to-one name="protocol"
				class="gov.nih.nci.calab.domain.Protocol" column="protocol_pk_id"
				not-null="true" lazy="false"/>
		</joined-subclass>
	</class>
</hibernate-mapping>

